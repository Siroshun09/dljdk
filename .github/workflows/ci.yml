name: Go Build
on: [ push, pull_request ]

jobs:
  test:
    uses: Siroshun09/gh-actions-workflows/.github/workflows/go-test.yml@v1
  lint:
    uses: Siroshun09/gh-actions-workflows/.github/workflows/go-lint.yml@v1
  build:
    needs: [ test, lint ]
    strategy:
      matrix:
        target_os: [ linux, darwin, windows ]
        target_arch: [ amd64, arm64 ]
      fail-fast: false
    uses: Siroshun09/gh-actions-workflows/.github/workflows/go-build.yml@v1
    with:
      target-os: ${{ matrix.target_os }}
      target-arch: ${{ matrix.target_arch }}
      go-filepath: "./cmd/dljdk/main.go"
      binary-name: dljdk
      package-name: dljdk-${{ github.run_number }}
